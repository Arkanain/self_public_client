"use strict";function Person(a){angular.extend(this,a)}angular.module("catawikiClientApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","mm.foundation","ui.tinymce","restangular","templates-main"]),angular.module("catawikiClientApp").config(["$routeProvider",function(a){a.when("/sign_in",{templateUrl:"views/sessions/new.html",controller:"SessionNewCtrl"}).when("/about_us",{templateUrl:"views/about_us/index.html",controller:"AboutUsCtrl"}).when("/articles",{templateUrl:"views/articles/index.html",controller:"ArticlesIndexCtrl"}).when("/articles/new",{templateUrl:"views/articles/new.html",controller:"ArticlesNewCtrl"}).when("/articles/:id",{templateUrl:"views/articles/show.html",controller:"ArticlesShowCtrl"}).when("/articles/:id/edit",{templateUrl:"views/articles/edit.html",controller:"ArticlesEditCtrl"}).when("/users",{templateUrl:"views/users/index.html",controller:"UsersIndexCtrl"}).when("/users/new",{templateUrl:"views/users/new.html",controller:"UsersNewCtrl"}).when("/users/:id",{templateUrl:"views/users/show.html",controller:"UsersShowCtrl"}).when("/users/:id/edit",{templateUrl:"views/users/edit.html",controller:"UsersEditCtrl"}).otherwise({redirectTo:"/articles"})}]),angular.module("catawikiClientApp").config(["RestangularProvider",function(a){var b="/api",c="http://self-publisher.herokuapp.com";"localhost"!==window.location.hostname&&(b=c+b),a.setBaseUrl(b),a.setDefaultHeaders({"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET, POST, PUT, DELETE"})}]).run(["Restangular","$cookies",function(a,b){a.setDefaultRequestParams({auth_token:b.get("auth_token")})}]).factory("Session",["Restangular",function(a){return a.all("sessions")}]).factory("Article",["Restangular",function(a){return a.all("articles")}]).factory("User",["Restangular",function(a){var b=a.all("users");return b.current_user=function(){return b.customGET("current_user")},b}]),Person.prototype={update:function(a){this.name=a}},Person.getPerson=function(){return new Person({name:"Steve"})},angular.module("catawikiClientApp").factory("personServise",function(){return{getPerson:Person.getPerson}}).provider("textObserver",function(){var a="Text",b=3;return{setText:function(b){a=b},$get:function(){function c(){return a}function d(){return b}return{getText:c,getNumber:d}}}}).config(["textObserverProvider",function(a){a.setText("Default Text")}]).config(["$provide",function(a){a.decorator("textObserver",["$delegate",function(a){return a.concatString=function(){return this.getNumber()+" - "+this.getText()},a}])}]).service("foo",function(){var a="private";this.variable="public",this.getPrivate=function(){return a}}),angular.module("catawikiClientApp").controller("MainCtrl",["$scope","$window","$cookies","User","Session",function(a,b,c,d,e){d.current_user().then(function(b){a.current_user=b,("admin"===b.role||"writer"===b.role)&&(a.can_write=!0)})["finally"](function(){a.authorized=!0}),a.sign_out=function(){e.remove({auth_token:c.get("auth_token")}).then(function(){b.location.hash="#/articles",b.location.reload(),c.remove("auth_token")})}}]),angular.module("catawikiClientApp").controller("AboutUsCtrl",["$scope",function(a){}]),angular.module("catawikiClientApp").controller("ArticlesIndexCtrl",["$scope","$routeParams","Article",function(a,b,c){c.getList().then(function(b){a.articles=b}),a["delete"]=function(b){a.articles[b].remove().then(function(){a.articles.splice(b,1)})}}]).controller("ArticlesNewCtrl",["$scope","$location","Article",function(a,b,c){a.submit=function(a){c.post(a).then(function(){b.url("/articles")})}}]).controller("ArticlesShowCtrl",["$scope","$routeParams","Article",function(a,b,c){c.get(b.id).then(function(b){a.article=b})}]).controller("ArticlesEditCtrl",["$scope","$routeParams","$location","Article",function(a,b,c,d){d.get(b.id).then(function(b){a.article=b}),a.submit=function(a){a.put().then(function(){c.url("/articles")})}}]).controller("ArticleFormCtrl",["$scope",function(a){a.tinymceOptions={menubar:!1}}]),angular.module("catawikiClientApp").controller("SessionNewCtrl",["$scope","$cookies","$location","$window","Session",function(a,b,c,d,e){a.current_user&&c.url("/articles"),a.sign_in=function(a){e.post(a).then(function(a){b.put("auth_token",a.auth_token),d.location.hash="#/articles",d.location.reload()})}}]),angular.module("catawikiClientApp").controller("UsersIndexCtrl",["$scope","$location","User",function(a,b,c){"admin"!==a.current_user.role&&b.url("/articles"),c.getList().then(function(b){a.users=b}),a["delete"]=function(b){a.users[b].remove().then(function(){a.users.splice(b,1)})}}]).controller("UsersNewCtrl",["$scope","$location","User",function(a,b,c){a.password_required="true",a.submit=function(a){c.post(a).then(function(){b.url("/users")})}}]).controller("UsersShowCtrl",["$scope","$routeParams","User",function(a,b,c){c.get(b.id).then(function(b){a.user=b})}]).controller("UsersEditCtrl",["$scope","$routeParams","$location","User",function(a,b,c,d){d.get(b.id).then(function(b){a.user=b}),a.password_required="false",a.submit=function(a){a.put().then(function(){c.url("/users")})}}]).controller("UsersFormCtrl",["$scope",function(a){a.roles=[{value:"admin",name:"Admin"},{value:"writer",name:"Writer"}]}]),angular.module("catawikiClientApp").controller("CommentFormCtrl",["$scope",function(a){a.tinymceOptions={menubar:!1},a.submit_comment=function(b){a.article.all("comments").post(b).then(function(b){a.article.comments=b,a.comment={}})}}]).controller("CommentIndexCtrl",["$scope",function(a){a.delete_comment=function(b){var c=a.article.comments[b];a.article.one("comments",c.id).remove().then(function(){a.article.comments.splice(b,1)})}}]),angular.module("catawikiClientApp").directive("ngReallyClick",["$window",function(a){return{restrict:"A",link:function(b,c,d){c.bind("click",function(){var c=d.ngReallyMessage;c&&a.confirm(c)&&b.$apply(d.ngReallyClick)})}}}]),angular.module("catawikiClientApp").filter("truncate",function(){return function(a,b,c,d){if(!a)return"";if(c=parseInt(c,10),!c)return a;if(a.length<=c)return a;if(a=a.substr(0,c),b){var e=a.lastIndexOf(" ");-1!==e&&(a=a.substr(0,e))}return a+(d||" ...")}});